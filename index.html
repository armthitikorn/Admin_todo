<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Dashboard - Roleplay Audios</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to right, #74ebd5, #ACB6E5);
      color: #333;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      padding: 20px;
    }
    h1 {
      text-align: center;
      color: #fff;
      margin-bottom: 30px;
      text-shadow: 1px 1px 2px #000;
    }
    .card {
      background: #fff;
      border-radius: 10px;
      padding: 15px;
      margin: 10px 0;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      animation: fadeIn 0.5s ease-in-out;
    }
    .card h3 {
      margin: 0 0 10px;
      color: #0077b6;
    }
    .card p {
      margin: 5px 0;
    }
    @keyframes fadeIn {
      from {opacity: 0;}
      to {opacity: 1;}
    }
    @media (max-width: 600px) {
      .card {
        padding: 10px;
      }
    }
  </style>
</head>
<body>

<div id="loginSection" style="text-align:center; margin-top:50px;">
  <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏´‡∏±‡∏ß‡∏´‡∏ô‡πâ‡∏≤</h2>
  <input type="text" id="username" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" style="padding:10px; margin:5px;">
  <input type="password" id="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" style="padding:10px; margin:5px;">
  <br>
  <button onclick="login()" style="padding:10px 20px; margin-top:10px;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
</div>
<script>
function login() {
  const user = document.getElementById('username').value;
  const pass = document.getElementById('password').value;
  if (user === 'admin' && pass === '123456') {
    document.getElementById('loginSection').style.display = 'none';
    document.getElementById('dashboard').style.display = 'block';
  } else {
    alert('‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
  }
}
</script>

<div id="dashboard" style="display:none;">
  <div class="container">
    <h1>üéß ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å Table Audios</h1>
    <div id="audioCards"></div>
  </div>

  <script>
    const supabaseUrl = 'https://wzwyotzzxycqfwercakh.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6d3lvdHp6eHljcWZ3ZXJjYWtoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwNTg3MTMsImV4cCI6MjA3MjYzNDcxM30.lgiAf9oBUqsaWGb3u_80wuoKAODQHE_lIBxpGumhrno';
    const client = window.supabase.createClient(supabaseUrl, supabaseKey);

    async function fetchAudios() {
      const { data, error } = await client.from('table_audios').select('*').order('created_at', { ascending: false });
      if (error) {
        console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
        return;
      }

      const container = document.getElementById('audioCards');
      container.innerHTML = '';

      data.forEach(row => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h3>${row.name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠'}</h3>
          <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> ${new Date(row.created_at).toLocaleString()}</p>
          <p><a href="${row.audio_url}" target="_blank">üîä ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏µ‡∏¢‡∏á</a></p>
        `;
        container.appendChild(card);
      });
    }

    fetchAudios();

    // Realtime subscription
    client.channel('audios_updates')
      .on('postgres_changes', { event: '*', schema: 'public', table: 'table_audios' }, fetchAudios)
      .subscribe();
  </script>
</div>
</body>
</html>
